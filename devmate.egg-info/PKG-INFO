Metadata-Version: 2.4
Name: devmate
Version: 0.1.0
Summary: DevMate: coding assistant agent with MCP, RAG and web search
Requires-Python: >=3.13
Description-Content-Type: text/markdown
Requires-Dist: langchain>=1.1.0
Requires-Dist: langchain-openai>=0.2.0
Requires-Dist: langchain-community>=0.3.0
Requires-Dist: langchain-deepseek>=0.1.0
Requires-Dist: langchain-text-splitters>=0.3.0
Requires-Dist: chromadb>=0.5.0
Requires-Dist: pydantic-settings>=2.5.0
Requires-Dist: tavily-python>=0.3.0
Requires-Dist: langsmith>=0.1.0
Requires-Dist: fastapi>=0.115.0
Requires-Dist: uvicorn>=0.30.0
Requires-Dist: huggingface-hub>=0.24.0
Requires-Dist: langchain-huggingface>=0.1.0
Requires-Dist: sentence-transformers>=2.2.2
Requires-Dist: modelcontextprotocol>=0.1.0

# DevMate (Stage 1 & 2 Snapshot)

本分支覆盖 Stage 1（环境/依赖/配置基线）与 Stage 2（MCP 搜索工具）。Agent/RAG/容器/观测性等后续阶段未在此分支实现。

## 已实现
- Stage 1：uv 管理的 Python 3.13 项目，LangChain 1.x 依赖（含 ChatDeepSeek、langchain-huggingface、sentence-transformers 等）声明于 `pyproject.toml`；配置经 `.env` / `config.toml` / `Settings` 读取；日志配置与敏感文件忽略。
- Stage 2：MCP 搜索
  - MCP 服务器：`mcp_server/main.py`，FastMCP `streamable-http` 传输；工具 `search_web` 调 Tavily（需 `TAVILY_API_KEY`），返回结构化 JSON + 文本。
  - MCP 客户端测试：`scripts/test_streamable_http_client.py` 可初始化会话、列工具并调用 `search_web`。
  - HTTP 直连兜底：`devmate/mcp_client/client.py` 支持 `http-direct` 调 `/tools/search_web`。

## 快速开始
1) 安装依赖  
```
uv sync
```

2) 配置关键变量  
- Tavily：`TAVILY_API_KEY`  
- LLM/Embedding：`MODEL_NAME`、`EMBEDDING_MODEL_NAME`；闭源时 `AI_BASE_URL`、`API_KEY`  
- 观测性：`LANGCHAIN_TRACING_V2`、`LANGCHAIN_API_KEY`、`LANGSMITH_API_KEY` / `LANGSMITH_PROJECT`

3) 最小环境验证（仅实例化，不会发真实请求）  
```
uv run python scripts/check_env.py
```

4) 启动 MCP 服务器（Stage 2）  
```
set TAVILY_API_KEY=your_key
uv run python -m mcp_server.main
```
默认监听 `http://127.0.0.1:8000/mcp`（或你设定的端口）。

5) 测试 MCP 客户端（Stage 2）  
```
uv run python scripts/test_streamable_http_client.py --query "model context protocol"
# 如改端口：
uv run python scripts/test_streamable_http_client.py --query "model context protocol" --url http://127.0.0.1:8010/mcp
```
预期：打印可用工具 `search_web`，输出 Tavily 搜索结果 JSON。

## 配置/文件速览
- `pyproject.toml`：LangChain 1.x、langchain-deepseek、langchain-huggingface、sentence-transformers 等依赖。
- `.env` / `config.toml`：LLM/Embedding/Tavily/LangSmith 等配置示例。
- `devmate/config.py`：配置加载优先级 env > `.env` > `config.toml`。
- `devmate/llm.py`：ChatOpenAI/ChatDeepSeek、OpenAI/HuggingFace Embeddings 工厂。
- `devmate/logging_utils.py`：stderr + 滚动日志。
- `scripts/check_env.py`：环境快速验证脚本。
- `scripts/test_streamable_http_client.py`：MCP 搜索工具手工测试脚本。

## 限制
- 仅涵盖 Stage 1/2；Agent、RAG、Docker/compose、观测性等未在此分支提供。
- 默认使用 `streamable-http`；SSE/stdio 在 Windows 上未做适配。***
